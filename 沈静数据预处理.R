a<-list.files('d:/s/')
dir<-paste('d:/s/',a,sep = '')
n<-length(dir)
data_1<-read.csv(dir[1],stringsAsFactors = F)
data_2<-read.csv(dir[2],stringsAsFactors = F)
data_3<-read.csv(dir[3],stringsAsFactors = F)
data_4<-read.csv(dir[4],stringsAsFactors = F)
colnames(data_3)<-colnames(data_1)
colnames(data_4)<-colnames(data_1)
colnames(data_2)<-colnames(data_1)
data<-rbind(data_1,data_2,data_3,data_4)
ID<-factor(data$Station.ID)              #????????????factor???????????????levels
ID<-levels(ID)                
for (j in 1:length(ID)) {
  data_o<-subset(data,Station.ID==ID[j])
  name<-paste(as.character(ID[j]),'.csv',sep='')           #ID?????????????????????????????????,???????????????????????????,???????????????????????????????????????????????????????????????
  write.csv(data_o,paste('d:/o/',name,sep=''))
}
rm(data_2,data_3,data_4,data_1,data)


data_5<-read.csv(dir[5],stringsAsFactors = F)
data_6<-read.csv(dir[6],stringsAsFactors = F)
data_7<-read.csv(dir[7],stringsAsFactors = F)
data_8<-read.csv(dir[8],stringsAsFactors = F)
colnames(data_7)<-colnames(data_1)
colnames(data_6)<-colnames(data_1)
data<-rbind(data_5,data_6,data_7,data_8)
ID<-factor(data$Station.ID)              #????????????factor???????????????levels
ID<-levels(ID)                
for (j in 1:length(ID)) {
  data_o<-subset(data,Station.ID==ID[j])
  name<-paste(as.character(ID[j]),'.csv',sep='')           #ID?????????????????????????????????,???????????????????????????,???????????????????????????????????????????????????????????????
  write.csv(data_o,paste('d:/o1/',name,sep = ''))
}
rm(data_5,data_6,data_7,data_8,data)


a<-list.files('d:/o/')
b<-list.files('d:/o1/')
for (i in 1:length(a)) {
  data_1<-read.csv(paste('d:/o/',a[i],sep=''))
  data_2<-read.csv(paste('d:/o1/',a[i],sep=''))              #???o1??????????????????o???????????????????????????
  data_3<-rbind(data_1,data_2)
  write.csv(data_3,paste('d:/o2/',a[i]))
  }